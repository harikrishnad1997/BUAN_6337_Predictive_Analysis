---
title: "Group_project_HXD220000_MXB220061_KXV220007_MXS220057"
output: html_document
date: "`r Sys.Date()`"
---

```{r}

require(data.table)
require(tidyverse)
require(partykit)
require(psych)

```

```{r}

data <- fread("heart.csv",stringsAsFactors = T)
str(data)
describe(data)

```

```{r}

require(ggplot2)
require(GGally)
ggpairs(data)
ggsave("ggpairs_data.png", width = 10, height = 10, dpi = 300,limitsize = FALSE)

```

```{r}
data[,HeartDisease:=as.factor(HeartDisease)]
ggpairs(data,column=1:11,ggplot2::aes(colour=HeartDisease))
ggsave("ggpairs_hd_data.png", width = 10, height = 10, dpi = 300,limitsize = FALSE)
```

```{r}
na <- is.na(data)
all(na == T)
```

```{r}
data_desc <- describe(data,IQR = TRUE)
data_desc
data_hd_desc <- describeBy(data,data$HeartDisease,IQR = TRUE)
data_hd_desc

```

```{r}

barplot(table(data$Sex), main = "Sex Distribution Plot")
barplot(table(data$ChestPainType), main = "Chest Distribution Plot")
barplot(table(data$FastingBS), main = "FastingBS Distribution Plot")
barplot(table(data$ExerciseAngina), main = "ExerciseAngina Distribution Plot")
barplot(table(data$ST_Slope), main = "ST_Slope Distribution Plot")
barplot(table(data$HeartDisease), main = "Heart Disease Distribution Plot")

```

```{r}

hist(data$Age,xlab = "Age",main = "Histogram of Age")
hist(data$RestingBP,xlab = "RestingBP",main = "Histogram of RestingBP")
hist(data$Cholesterol,xlab = "Cholesterol",main = "Histogram of Cholesterol")
hist(data$Cholesterol,xlab = "Cholesterol",main = "Histogram of Cholesterol")
hist(data$Oldpeak,xlab = "Oldpeak",main = "Histogram of Oldpeak")

```

```{r}

pie(table(data$HeartDisease),labels = names(data$HeartDisease),main = "Heart Disease")

barplot(table(data$HeartDisease),main = "Heart Disease")

```